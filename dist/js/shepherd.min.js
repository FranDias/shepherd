!function(t,e){"function"==typeof define&&define.amd?define(["popper"],e):"object"==typeof exports?module.exports=e(require("popper")):t.Shepherd=e(t.Popper)}(this,function(n){"use strict";var s=function(t,e,i){for(var n=!0;n;){var s=t,o=e,r=i;n=!1,null===s&&(s=Function.prototype);var h=Object.getOwnPropertyDescriptor(s,o);if(void 0!==h){if("value"in h)return h.value;var a=h.get;if(void 0===a)return;return a.call(r)}var l=Object.getPrototypeOf(s);if(null===l)return;t=l,e=o,i=r,n=!0,h=l=void 0}},o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var t,p=(t=0,function(){return++t});function a(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1;n<arguments.length;n++){var s=arguments[n];if(null!=s)for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i}function u(t){return void 0===t}function l(t){return"object"==typeof t}function c(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}var d=/^(.+) (top|left|right|bottom|center)$/;var f=function(){function t(){arguments.length<=0||void 0===arguments[0]||arguments[0];h(this,t)}return o(t,[{key:"on",value:function(t,e,i){var n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];void 0===this.bindings&&(this.bindings={}),void 0===this.bindings[t]&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:i,once:n})}},{key:"once",value:function(t,e,i){this.on(t,e,i,!0)}},{key:"off",value:function(t,e){if(void 0!==this.bindings&&void 0!==this.bindings[t])if(void 0===e)delete this.bindings[t];else for(var i=0;i<this.bindings[t].length;)this.bindings[t][i].handler===e?this.bindings[t].splice(i,1):++i}},{key:"trigger",value:function(t){if(void 0!==this.bindings&&this.bindings[t]){for(var e=arguments.length,i=Array(1<e?e-1:0),n=0,s=1;s<e;s++)i[s-1]=arguments[s];for(;n<this.bindings[t].length;){var o=this.bindings[t][n],r=o.handler,h=o.ctx,a=o.once,l=h;void 0===l&&(l=this),r.apply(l,i),a?this.bindings[t].splice(n,1):++n}}}}]),t}(),i=function(t){function i(t,e){return h(this,i),s(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,t,e),this.tour=t,this.bindMethods(),this.setOptions(e),this}return r(i,f),o(i,[{key:"bindMethods",value:function(){var e=this;["_show","show","hide","isOpen","cancel","complete","scrollTo","destroy","render"].map(function(t){e[t]=e[t].bind(e)})}},{key:"setOptions",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t,this.destroy(),this.id=this.options.id||this.id||"step-"+p();var e=this.options.when;if(e)for(var i in e)if({}.hasOwnProperty.call(e,i)){var n=e[i];this.on(i,n,this)}var s,o,r=JSON.stringify(this.options.buttons),h=u(r)||"true"===r,a="{}"===r||"[]"===r||"null"===r||"false"===r,l=!h&&((s=this.options.buttons)&&s.constructor===Array),c=!h&&((o=this.options.buttons)&&o.constructor===Object);h?this.options.buttons=[{text:"Next",action:this.tour.next,classes:"btn"}]:!a&&c?this.options.buttons=[this.options.buttons]:!a&&l||(this.options.buttons=!1)}},{key:"getTour",value:function(){return this.tour}},{key:"bindAdvance",value:function(){var s=this,t=function(t,e){if(null===t||u(t))return t;if(l(t))return t;for(var i=t.split(" "),n={},s=e.length-1,o=i.length-1;0<=o;o--){if(0===s){n[e[s]]=i.slice(0,o+1).join(" ");break}n[e[s]]=i[o],s--}return n}(this.options.advanceOn,["selector","event"]),e=t.event,o=t.selector,i=function(t){var e,i,n;s.isOpen()&&(u(o)?s.el&&t.target===s.el&&s.tour.next():(e=t.target,i=o,n=void 0,u(e.matches)?u(e.matchesSelector)?u(e.msMatchesSelector)?u(e.webkitMatchesSelector)?u(e.mozMatchesSelector)?u(e.oMatchesSelector)||(n=e.oMatchesSelector):n=e.mozMatchesSelector:n=e.webkitMatchesSelector:n=e.msMatchesSelector:n=e.matchesSelector:n=e.matches,n.call(e,i)&&s.tour.next()))};document.body.addEventListener(e,i),this.on("destroy",function(){return document.body.removeEventListener(e,i)})}},{key:"getAttachTo",value:function(){var t=function(t){if(l(t))return t.hasOwnProperty("element")&&t.hasOwnProperty("on")?t:null;var e=d.exec(t);if(!e)return null;var i=e[2];return"["===i[0]&&(i=i.substring(1,i.length-1)),{element:e[1],on:i}}(this.options.attachTo)||{},e=a({},t);return"string"==typeof t.element&&(e.element=document.querySelector(t.element),e.element||console.error("The element for this Shepherd step was not found "+t.element)),e}},{key:"setupPopper",value:function(){if(u(n))throw new Error("Using the attachment feature of Shepherd requires the Popper.js library");var t=this.getAttachTo();t.modifiers=t.modifiers||{};var e=t.on||"right";t.positionFixed=!1,u(t.element)&&(t.element=document.body,e="top",t.modifiers=a({offset:{enabled:!0,offset:"0,50vh"},flip:{enabled:!1},hide:{enabled:!1},inner:{enabled:!0},keepTogether:{enabled:!1},preventOverflow:{enabled:!1,padding:0}},t.modifiers),t.positionFixed=!0);var i=a({},{placement:e,arrowElement:this.el.querySelector(".popper__arrow"),modifiers:t.modifiers,positionFixed:t.positionFixed},this.options.popperOptions);this.popper&&this.popper.destroy(),this.el.classList.add("shepherd-element"),this.popper=new n(t.element,this.el,i),this.target=t.element,this.target.classList.add("shepherd-target"),this.target.classList.add("shepherd-enabled")}},{key:"show",value:function(){var t=this;if(!u(this.options.beforeShowPromise)){var e=this.options.beforeShowPromise();if(!u(e))return e.then(function(){return t._show()})}this._show()}},{key:"_show",value:function(){var t=this;this.trigger("before-show"),this.el||this.render(),this.el.classList.add("shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupPopper(),this.options.scrollTo&&setTimeout(function(){t.scrollTo()}),this.trigger("show")}},{key:"hide",value:function(){this.trigger("before-hide"),this.el.classList.remove("shepherd-open"),document.body.removeAttribute("data-shepherd-step"),this.target&&this.target.classList.remove("shepherd-enabled"),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("hide")}},{key:"isOpen",value:function(){return this.el&&this.el.classList.hasClass("shepherd-open")}},{key:"cancel",value:function(){this.tour.cancel(),this.trigger("cancel")}},{key:"complete",value:function(){this.tour.complete(),this.trigger("complete")}},{key:"scrollTo",value:function(){var t=this.getAttachTo().element;u(this.options.scrollToHandler)?u(t)||t.scrollIntoView():this.options.scrollToHandler(t)}},{key:"destroy",value:function(){!u(this.el)&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),delete this.el),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("destroy")}},{key:"render",value:function(){var i=this;u(this.el)||this.destroy(),this.el=c("<div class='shepherd-step "+(this.options.classes||"")+"' data-id='"+this.id+"' "+(this.options.idAttribute?'id="'+this.options.idAttribute+'"':"")+">"),this.options.attachTo&&this.el.appendChild(c('<div class="popper__arrow" x-arrow></div>'));var t=document.createElement("div");t.className="shepherd-content",this.el.appendChild(t);var e,n,s,o,r=document.createElement("header");if(t.appendChild(r),this.options.title&&(r.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink){var h=c("<a href class='shepherd-cancel-link'>âœ•</a>");r.appendChild(h),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(h)}u(this.options.text)||(e=c("<div class='shepherd-text'></div>"),"function"==typeof(n=i.options.text)&&(n=n.call(i,e)),n instanceof HTMLElement?e.appendChild(n):("string"==typeof n&&(n=[n]),n.map(function(t){e.innerHTML+="<p>"+t+"</p>"})),t.appendChild(e)),this.options.buttons&&(s=document.createElement("footer"),o=c("<ul class='shepherd-buttons'></ul>"),i.options.buttons.map(function(t){var e=c("<li><a class='shepherd-button "+(t.classes||"")+"'>"+t.text+"</a>");o.appendChild(e),i.bindButtonEvents(t,e.querySelector("a"))}),s.appendChild(o),t.appendChild(s)),document.body.appendChild(this.el),this.setupPopper(),this.options.advanceOn&&this.bindAdvance()}},{key:"bindCancelLink",value:function(t){var e=this;t.addEventListener("click",function(t){t.preventDefault(),e.cancel()})}},{key:"bindButtonEvents",value:function(i,n){var e=this;for(var t in i.events=i.events||{},u(i.action)||(i.events.click=i.action),i.events)if({}.hasOwnProperty.call(i.events,t)){var s=i.events[t];"string"==typeof s&&function(){var t=s;s=function(){return e.tour.show(t)}}(),n.addEventListener(t,s)}this.on("destroy",function(){for(var t in i.events)if({}.hasOwnProperty.call(i.events,t)){var e=i.events[t];n.removeEventListener(t,e)}})}}]),i}(),e=function(t){function e(){var i=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];h(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.bindMethods(),this.options=t,this.steps=this.options.steps||[];return["complete","cancel","hide","start","show","active","inactive"].map(function(t){var e;e=t,i.on(e,function(t){(t=t||{}).tour=i,v.trigger(e,t)})}),this}return r(e,f),o(e,[{key:"bindMethods",value:function(){var e=this;["next","back","cancel","complete","hide"].map(function(t){e[t]=e[t].bind(e)})}},{key:"addStep",value:function(t,e){return u(e)&&(e=t),e instanceof i?e.tour=this:("string"!=typeof t&&"number"!=typeof t||(e.id=t.toString()),e=a({},this.options.defaults,e),e=new i(this,e)),this.steps.push(e),this}},{key:"removeStep",value:function(t){for(var e=this.getCurrentStep(),i=0;i<this.steps.length;++i){var n=this.steps[i];if(n.id===t){n.isOpen()&&n.hide(),n.destroy(),this.steps.splice(i,1);break}}e&&e.id===t&&(this.currentStep=void 0,this.steps.length?this.show(0):this.hide())}},{key:"getById",value:function(t){for(var e=0;e<this.steps.length;++e){var i=this.steps[e];if(i.id===t)return i}}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"next",value:function(){var t=this.steps.indexOf(this.currentStep);t===this.steps.length-1?(this.hide(t),this.trigger("complete"),this.done()):this.show(t+1,!0)}},{key:"back",value:function(){var t=this.steps.indexOf(this.currentStep);this.show(t-1,!1)}},{key:"cancel",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("cancel"),this.done()}},{key:"complete",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("complete"),this.done()}},{key:"hide",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("hide"),this.done()}},{key:"done",value:function(){v.activeTour=null,document.body.classList.remove("shepherd-active"),this.trigger("inactive",{tour:this})}},{key:"show",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]||arguments[1];this.currentStep?this.currentStep.hide():(document.body.classList.add("shepherd-active"),this.trigger("active",{tour:this})),v.activeTour=this;var i=void 0;if(i="string"==typeof t?this.getById(t):this.steps[t])if(u(i.options.showOn)||i.options.showOn())this.trigger("show",{step:i,previous:this.currentStep}),this.currentStep&&this.currentStep.hide(),(this.currentStep=i).show();else{var n=this.steps.indexOf(i),s=e?n+1:n-1;this.show(s,e)}}},{key:"start",value:function(){this.trigger("start"),this.currentStep=null,this.next()}}]),e}(),v=new f;return a(v,{Tour:e,Step:i,Evented:f}),v});