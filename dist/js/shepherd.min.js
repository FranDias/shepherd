!function(e,t){"function"==typeof define&&define.amd?define(["popper"],t):"object"==typeof exports?module.exports=t(require("popper")):e.Shepherd=t(e.Popper)}(this,function(e){"use strict";function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var s=arguments[n];if(null!=s)for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i}function s(e){return"undefined"==typeof e}function o(e){return e&&e.constructor===Array}function r(e){return e&&e.constructor===Object}function h(e){return"object"==typeof e}function a(e){var t=document.createElement("div");return t.innerHTML=e,t.children[0]}function c(e,t){var i=void 0;return s(e.matches)?s(e.matchesSelector)?s(e.msMatchesSelector)?s(e.webkitMatchesSelector)?s(e.mozMatchesSelector)?s(e.oMatchesSelector)||(i=e.oMatchesSelector):i=e.mozMatchesSelector:i=e.webkitMatchesSelector:i=e.msMatchesSelector:i=e.matchesSelector:i=e.matches,i.call(e,t)}function l(e){if(h(e))return e.hasOwnProperty("element")&&e.hasOwnProperty("on")?e:null;var t=v.exec(e);if(!t)return null;var i=t[2];return"["===i[0]&&(i=i.substring(1,i.length-1)),{element:t[1],on:i}}function u(e,t){if(null===e||s(e))return e;if(h(e))return e;for(var i=e.split(" "),n={},o=t.length-1,r=i.length-1;r>=0;r--){if(0===o){n[t[o]]=i.slice(0,r+1).join(" ");break}n[t[o]]=i[r],o--}return n}var p=function(e,t,i){for(var n=!0;n;){var s=e,o=t,r=i;n=!1,null===s&&(s=Function.prototype);var h=Object.getOwnPropertyDescriptor(s,o);if(void 0!==h){if("value"in h)return h.value;var a=h.get;if(void 0===a)return;return a.call(r)}var c=Object.getPrototypeOf(s);if(null===c)return;e=c,t=o,i=r,n=!0,h=c=void 0}},d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),f=function(){var e=0;return function(){return++e}}(),v=/^(.+) (top|left|right|bottom|center)$/,y=function(){function e(){arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e)}return d(e,[{key:"on",value:function(e,t,i){var n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[e]&&(this.bindings[e]=[]),this.bindings[e].push({handler:t,ctx:i,once:n})}},{key:"once",value:function(e,t,i){this.on(e,t,i,!0)}},{key:"off",value:function(e,t){if("undefined"!=typeof this.bindings&&"undefined"!=typeof this.bindings[e])if("undefined"==typeof t)delete this.bindings[e];else for(var i=0;i<this.bindings[e].length;)this.bindings[e][i].handler===t?this.bindings[e].splice(i,1):++i}},{key:"trigger",value:function(e){if("undefined"!=typeof this.bindings&&this.bindings[e]){for(var t=arguments.length,i=Array(t>1?t-1:0),n=0,s=1;s<t;s++)i[s-1]=arguments[s];for(;n<this.bindings[e].length;){var o=this.bindings[e][n],r=o.handler,h=o.ctx,a=o.once,c=h;"undefined"==typeof c&&(c=this),r.apply(c,i),a?this.bindings[e].splice(n,1):++n}}}}]),e}(),g=function(h){function v(e,t){return i(this,v),p(Object.getPrototypeOf(v.prototype),"constructor",this).call(this,e,t),this.tour=e,this.bindMethods(),this.setOptions(t),this}return t(v,h),d(v,[{key:"bindMethods",value:function(){var e=this,t=["_show","show","hide","isOpen","cancel","complete","scrollTo","destroy","render"];t.map(function(t){e[t]=e[t].bind(e)})}},{key:"setOptions",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=e,this.destroy(),this.id=this.options.id||this.id||"step-"+f();var t=this.options.when;if(t)for(var i in t)if({}.hasOwnProperty.call(t,i)){var n=t[i];this.on(i,n,this)}var h=JSON.stringify(this.options.buttons),a=s(h)||"true"===h,c="{}"===h||"[]"===h||"null"===h||"false"===h,l=!a&&o(this.options.buttons),u=!a&&r(this.options.buttons);a?this.options.buttons=[{text:"Next",action:this.tour.next,classes:"btn"}]:!c&&u?this.options.buttons=[this.options.buttons]:!c&&l||(this.options.buttons=!1)}},{key:"getTour",value:function(){return this.tour}},{key:"bindAdvance",value:function(){var e=this,t=u(this.options.advanceOn,["selector","event"]),i=t.event,n=t.selector,o=function(t){e.isOpen()&&(s(n)?e.el&&t.target===e.el&&e.tour.next():c(t.target,n)&&e.tour.next())};document.body.addEventListener(i,o),this.on("destroy",function(){return document.body.removeEventListener(i,o)})}},{key:"getAttachTo",value:function(){var e=l(this.options.attachTo)||{},t=n({},e);return"string"==typeof e.element&&(t.element=document.querySelector(e.element),t.element||console.error("The element for this Shepherd step was not found "+e.element)),t}},{key:"setupPopper",value:function(){if(s(e))throw new Error("Using the attachment feature of Shepherd requires the Popper.js library");var t=this.getAttachTo();t.modifiers=t.modifiers||{};var i=t.on||"right";t.positionFixed=!1,s(t.element)&&(t.element=document.body,i="top",t.modifiers=n({flip:{enabled:!1},hide:{enabled:!1},inner:{enabled:!0},keepTogether:{enabled:!1},preventOverflow:{enabled:!1,padding:0}},t.modifiers),t.positionFixed=!0);var o=n({},{placement:i,arrowElement:this.el.querySelector(".popper__arrow"),modifiers:t.modifiers,positionFixed:t.positionFixed},this.options.popperOptions);this.popper&&this.popper.destroy(),this.el.classList.add("shepherd-element"),this.popper=new e(t.element,this.el,o),this.target=t.element,this.target.classList.add("shepherd-target"),this.target.classList.add("shepherd-enabled")}},{key:"show",value:function(){var e=this;if(!s(this.options.beforeShowPromise)){var t=this.options.beforeShowPromise();if(!s(t))return t.then(function(){return e._show()})}this._show()}},{key:"_show",value:function(){var e=this;this.trigger("before-show"),this.el||this.render(),this.el.classList.add("shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupPopper(),this.options.scrollTo&&setTimeout(function(){e.scrollTo()}),this.trigger("show")}},{key:"hide",value:function(){this.trigger("before-hide"),this.el.classList.remove("shepherd-open"),document.body.removeAttribute("data-shepherd-step"),this.target&&this.target.classList.remove("shepherd-enabled"),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("hide")}},{key:"isOpen",value:function(){return this.el&&this.el.classList.hasClass("shepherd-open")}},{key:"cancel",value:function(){this.tour.cancel(),this.trigger("cancel")}},{key:"complete",value:function(){this.tour.complete(),this.trigger("complete")}},{key:"scrollTo",value:function(){var e=this.getAttachTo(),t=e.element;s(this.options.scrollToHandler)?s(t)||t.scrollIntoView():this.options.scrollToHandler(t)}},{key:"destroy",value:function(){!s(this.el)&&this.el.parentNode&&(this.el.parentNode.removeChild(this.el),delete this.el),this.popper&&this.popper.destroy(),this.popper=null,this.trigger("destroy")}},{key:"render",value:function(){var e=this;s(this.el)||this.destroy(),this.el=a("<div class='shepherd-step "+(this.options.classes||"")+"' data-id='"+this.id+"' "+(this.options.idAttribute?'id="'+this.options.idAttribute+'"':"")+">"),this.options.attachTo&&this.el.appendChild(a('<div class="popper__arrow" x-arrow></div>'));var t=document.createElement("div");t.className="shepherd-content",this.el.appendChild(t);var i=document.createElement("header");if(t.appendChild(i),this.options.title&&(i.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink){var n=a("<a href class='shepherd-cancel-link'>âœ•</a>");i.appendChild(n),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(n)}s(this.options.text)||!function(){var i=a("<div class='shepherd-text'></div>"),n=e.options.text;"function"==typeof n&&(n=n.call(e,i)),n instanceof HTMLElement?i.appendChild(n):("string"==typeof n&&(n=[n]),n.map(function(e){i.innerHTML+="<p>"+e+"</p>"})),t.appendChild(i)}(),this.options.buttons&&!function(){var i=document.createElement("footer"),n=a("<ul class='shepherd-buttons'></ul>");e.options.buttons.map(function(t){var i=a("<li><a class='shepherd-button "+(t.classes||"")+"'>"+t.text+"</a>");n.appendChild(i),e.bindButtonEvents(t,i.querySelector("a"))}),i.appendChild(n),t.appendChild(i)}(),document.body.appendChild(this.el),this.setupPopper(),this.options.advanceOn&&this.bindAdvance()}},{key:"bindCancelLink",value:function(e){var t=this;e.addEventListener("click",function(e){e.preventDefault(),t.cancel()})}},{key:"bindButtonEvents",value:function(e,t){var i=this;e.events=e.events||{},s(e.action)||(e.events.click=e.action);for(var n in e.events)if({}.hasOwnProperty.call(e.events,n)){var o=e.events[n];"string"==typeof o&&!function(){var e=o;o=function(){return i.tour.show(e)}}(),t.addEventListener(n,o)}this.on("destroy",function(){for(var i in e.events)if({}.hasOwnProperty.call(e.events,i)){var n=e.events[i];t.removeEventListener(i,n)}})}}]),v}(y),b=function(e){function o(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,o),p(Object.getPrototypeOf(o.prototype),"constructor",this).call(this,t),this.bindMethods(),this.options=t,this.steps=this.options.steps||[];var n=["complete","cancel","hide","start","show","active","inactive"];return n.map(function(t){!function(t){e.on(t,function(i){i=i||{},i.tour=e,m.trigger(t,i)})}(t)}),this}return t(o,e),d(o,[{key:"bindMethods",value:function(){var e=this,t=["next","back","cancel","complete","hide"];t.map(function(t){e[t]=e[t].bind(e)})}},{key:"addStep",value:function(e,t){return s(t)&&(t=e),t instanceof g?t.tour=this:("string"!=typeof e&&"number"!=typeof e||(t.id=e.toString()),t=n({},this.options.defaults,t),t=new g(this,t)),this.steps.push(t),this}},{key:"removeStep",value:function(e){for(var t=this.getCurrentStep(),i=0;i<this.steps.length;++i){var n=this.steps[i];if(n.id===e){n.isOpen()&&n.hide(),n.destroy(),this.steps.splice(i,1);break}}t&&t.id===e&&(this.currentStep=void 0,this.steps.length?this.show(0):this.hide())}},{key:"getById",value:function(e){for(var t=0;t<this.steps.length;++t){var i=this.steps[t];if(i.id===e)return i}}},{key:"getCurrentStep",value:function(){return this.currentStep}},{key:"next",value:function(){var e=this.steps.indexOf(this.currentStep);e===this.steps.length-1?(this.hide(e),this.trigger("complete"),this.done()):this.show(e+1,!0)}},{key:"back",value:function(){var e=this.steps.indexOf(this.currentStep);this.show(e-1,!1)}},{key:"cancel",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("cancel"),this.done()}},{key:"complete",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("complete"),this.done()}},{key:"hide",value:function(){this.currentStep&&this.currentStep.hide(),this.trigger("hide"),this.done()}},{key:"done",value:function(){m.activeTour=null,document.body.classList.remove("shepherd-active"),this.trigger("inactive",{tour:this})}},{key:"show",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]||arguments[1];this.currentStep?this.currentStep.hide():(document.body.classList.add("shepherd-active"),this.trigger("active",{tour:this})),m.activeTour=this;var i=void 0;if(i="string"==typeof e?this.getById(e):this.steps[e])if(s(i.options.showOn)||i.options.showOn())this.trigger("show",{step:i,previous:this.currentStep}),this.currentStep&&this.currentStep.hide(),this.currentStep=i,i.show();else{var n=this.steps.indexOf(i),o=t?n+1:n-1;this.show(o,t)}}},{key:"start",value:function(){this.trigger("start"),this.currentStep=null,this.next()}}]),o}(y),m=new y;return n(m,{Tour:b,Step:g,Evented:y}),m});